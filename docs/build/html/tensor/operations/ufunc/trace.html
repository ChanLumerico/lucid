

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lucid.trace &mdash; Lucid 0.10 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=3d3fbe02" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="canonical" href="https://chanlumerico.github.io/lucid/tensor/operations/ufunc/trace.html" />
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=ac14934e"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="lucid.mean" href="mean.html" />
    <link rel="prev" title="lucid.sum" href="sum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Lucid
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tensor</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Tensor.html">lucid.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensor.html">lucid.tensor</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tensor Operations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="exp.html">lucid.exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="log.html">lucid.log</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqrt.html">lucid.sqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="sin.html">lucid.sin</a></li>
<li class="toctree-l2"><a class="reference internal" href="cos.html">lucid.cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="tan.html">lucid.tan</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcsin.html">lucid.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="arccos.html">lucid.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="arctan.html">lucid.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="sinh.html">lucid.sinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosh.html">lucid.cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="tanh.html">lucid.tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="clip.html">lucid.clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="abs.html">lucid.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sign.html">lucid.sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="reciprocal.html">lucid.reciprocal</a></li>
<li class="toctree-l2"><a class="reference internal" href="square.html">lucid.square</a></li>
<li class="toctree-l2"><a class="reference internal" href="cube.html">lucid.cube</a></li>
<li class="toctree-l2"><a class="reference internal" href="transpose.html">lucid.transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="sum.html">lucid.sum</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">lucid.trace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lucid.trace"><code class="docutils literal notranslate"><span class="pre">trace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-signature">Function Signature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#returns">Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forward-calculation">Forward Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backward-gradient-calculation">Backward Gradient Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mean.html">lucid.mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="var.html">lucid.var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/add.html">lucid.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/sub.html">lucid.sub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/mul.html">lucid.mul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/div.html">lucid.div</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/minimum.html">lucid.minimum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/maximum.html">lucid.maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/power.html">lucid.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/dot.html">lucid.dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/inner.html">lucid.inner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfunc/matmul.html">lucid.matmul</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Linear Algebra</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../linalg/inv.html">lucid.linalg.inv</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Types</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../types/types.html">lucid.types</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Lucid</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Tensor Operations</a></li>
      <li class="breadcrumb-item active">lucid.trace</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tensor/operations/ufunc/trace.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lucid-trace">
<h1>lucid.trace<a class="headerlink" href="#lucid-trace" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="lucid.trace">
<span class="sig-prename descclassname"><span class="pre">lucid.</span></span><span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lucid.trace" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../Tensor.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<p>The <cite>trace</cite> function computes the sum of the diagonal elements of a tensor.
If the tensor is 2D, it behaves similarly to <cite>numpy.trace</cite>, returning the sum of the diagonal elements.</p>
<section id="function-signature">
<h2>Function Signature<a class="headerlink" href="#function-signature" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span>
</pre></div>
</div>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><dl class="simple">
<dt><strong>a</strong> (<em>Tensor</em>):</dt><dd><p>The input tensor for which the trace is calculated. The tensor should be at least 2-dimensional.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Tensor</strong>:</dt><dd><p>A new tensor containing the sum of the diagonal elements of the input tensor.
If the input tensor has more than two dimensions, only the diagonal elements
of the 2D slices will be summed.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="forward-calculation">
<h2>Forward Calculation<a class="headerlink" href="#forward-calculation" title="Link to this heading"></a></h2>
<p>The forward calculation for <cite>trace</cite> is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{out}_i = \sum_{i=1}^{n} \mathbf{a}_{ii}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}_{ii}\)</span> represents the diagonal elements of the input tensor
<span class="math notranslate nohighlight">\(\mathbf{a}\)</span>, and the sum is taken over the diagonal elements.</p>
<p>If the tensor has more than two dimensions, the trace is calculated over the 2D slices,
i.e., each slice’s diagonal elements are summed.</p>
</section>
<section id="backward-gradient-calculation">
<h2>Backward Gradient Calculation<a class="headerlink" href="#backward-gradient-calculation" title="Link to this heading"></a></h2>
<p>For the backward pass, the gradient with respect to the input tensor <strong>a</strong>
is computed by distributing the gradient of the output tensor along the diagonal elements:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathbf{out}}{\partial \mathbf{a}_{ii}} = 1\]</div>
<p>This means that the gradient with respect to each diagonal element is 1,
and other elements do not contribute to the gradient.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">lucid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">lucid</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">Tensor(5, grad=None)</span>
</pre></div>
</div>
<p>The <cite>trace</cite> function supports tensors with more than two dimensions by
summing the diagonal elements of each 2D slice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">lucid</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">Tensor([5 15], grad=None)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The input tensor must be at least 2-dimensional.
For 1D tensors, the result is simply the sum of all elements (equivalent to a sum operation).</p></li>
<li><p>The <cite>trace</cite> function operates element-wise on 2D slices of the tensor
for tensors with more than two dimensions.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sum.html" class="btn btn-neutral float-left" title="lucid.sum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mean.html" class="btn btn-neutral float-right" title="lucid.mean" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, ChanLumerico.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>