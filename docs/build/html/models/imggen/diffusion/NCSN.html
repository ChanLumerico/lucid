<!DOCTYPE html>
<html lang="en" data-accent-color="indigo" data-content_root="../../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NCSN - Lucid 2.13.0 documentation</title><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Object Detection" href="../../objdet/index.html" /><link rel="prev" title="DDPM" href="DDPM.html" />
      <link rel="canonical" href="https://chanlumerico.github.io/lucid/models/imggen/diffusion/NCSN.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../../../_static/shibuya.css?v=44020203" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../../../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../../../_static/badges.css?v=b1c3d602" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mermaid.css?v=71a6aa26" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://chanlumerico.github.io/lucid/models/imggen/diffusion/NCSN.html"/>
  <meta property="og:title" content="NCSN"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../../index.html">
      
      
      <strong>Lucid</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials"></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Tensor</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor/Tensor_.html">lucid.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor/tensor.html">lucid.tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor/operations/index.html">Tensor Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/exp.html">lucid.exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/log.html">lucid.log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/log2.html">lucid.log2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/sqrt.html">lucid.sqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/sin.html">lucid.sin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/cos.html">lucid.cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/tan.html">lucid.tan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/arcsin.html">lucid.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/arccos.html">lucid.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/arctan.html">lucid.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/sinh.html">lucid.sinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/cosh.html">lucid.cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/tanh.html">lucid.tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/clip.html">lucid.clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/abs.html">lucid.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/sign.html">lucid.sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/reciprocal.html">lucid.reciprocal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/square.html">lucid.square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/cube.html">lucid.cube</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/transpose.html">lucid.transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/sum.html">lucid.sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/trace.html">lucid.trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/mean.html">lucid.mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/var.html">lucid.var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/min.html">lucid.min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/max.html">lucid.max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/swapaxes.html">lucid.swapaxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/round.html">lucid.round</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/floor.html">lucid.floor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/ceil.html">lucid.ceil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/cumprod.html">lucid.cumprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/ufunc/cumsum.html">lucid.cumsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/add.html">lucid.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/sub.html">lucid.sub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/multiply.html">lucid.multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/div.html">lucid.div</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/minimum.html">lucid.minimum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/maximum.html">lucid.maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/power.html">lucid.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/dot.html">lucid.dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/inner.html">lucid.inner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/outer.html">lucid.outer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/matmul.html">lucid.matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/bfunc/tensordot.html">lucid.tensordot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/zeros.html">lucid.zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/zeros_like.html">lucid.zeros_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/ones.html">lucid.ones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/ones_like.html">lucid.ones_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/eye.html">lucid.eye</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/diag.html">lucid.diag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/arange.html">lucid.arange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/empty.html">lucid.empty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/empty_like.html">lucid.empty_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/linspace.html">lucid.linspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/full.html">lucid.full</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/operations/gfunc/full_like.html">lucid.full_like</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tensor/utilities/index.html">Tensor Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/reshape.html">lucid.reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/squeeze.html">lucid.squeeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/unsqueeze.html">lucid.unsqueeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/ravel.html">lucid.ravel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/stack.html">lucid.stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/hstack.html">lucid.hstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/vstack.html">lucid.vstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/concatenate.html">lucid.concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/pad.html">lucid.pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/repeat.html">lucid.repeat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/tile.html">lucid.tile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/flatten.html">lucid.flatten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/meshgrid.html">lucid.meshgrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/split.html">lucid.split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/tril.html">lucid.tril</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/triu.html">lucid.triu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/broadcast_to.html">lucid.broadcast_to</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/expand.html">lucid.expand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/chunk.html">lucid.chunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/masked_fill.html">lucid.masked_fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/roll.html">lucid.roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/gather.html">lucid.gather</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/unbind.html">lucid.unbind</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/sort.html">lucid.sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/argsort.html">lucid.argsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/argmin.html">lucid.argmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/argmax.html">lucid.argmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/nonzero.html">lucid.nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/unique.html">lucid.unique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/topk.html">lucid.topk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/histogram.html">lucid.histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/histogram2d.html">lucid.histogram2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/histogramdd.html">lucid.histogramdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/where.html">lucid.where</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor/utilities/diagonal.html">lucid.diagonal</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Autograd</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autograd/autograd.html">lucid.autograd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autograd/index.html">Autograd APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../autograd/backward.html">lucid.autograd.backward</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autograd/grad.html">lucid.autograd.grad</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Linear Algebra</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../linalg/linalg.html">lucid.linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../linalg/operations/index.html">Linalg Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/det.html">lucid.linalg.det</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/inv.html">lucid.linalg.inv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/solve.html">lucid.linalg.solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/norm.html">lucid.linalg.norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/cholesky.html">lucid.linalg.cholesky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/eig.html">lucid.linalg.eig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/qr.html">lucid.linalg.qr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/svd.html">lucid.linalg.svd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/matrix_power.html">lucid.linalg.matrix_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linalg/operations/pinv.html">lucid.linalg.pinv</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Random</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../random/random.html">lucid.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../random/functions/index.html">RNG Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/seed.html">lucid.random.seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/rand.html">lucid.random.rand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/randint.html">lucid.random.randint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/randn.html">lucid.random.randn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/uniform.html">lucid.random.uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/bernoulli.html">lucid.random.bernoulli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../random/functions/permutation.html">lucid.random.permutation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Einstein Operations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../einops/einops.html">lucid.einops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../einops/functions/index.html">Einops Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../einops/functions/rearrange.html">lucid.einops.rearrange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../einops/functions/reduce.html">lucid.einops.reduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../einops/functions/repeat.html">lucid.einops.repeat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../einops/functions/einsum.html">lucid.einops.einsum</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Neural Networks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/nn.html">lucid.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/Parameter.html">nn.Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/Buffer.html">nn.Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/Module.html">nn.Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/ModuleHooks.html">Module Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/functions/index.html">Neural Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/linear/index.html">Linear Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/linear/linear.html">nn.functional.linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/linear/bilinear.html">nn.functional.bilinear</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/activation/index.html">Activation Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/relu.html">nn.functional.relu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/leaky_relu.html">nn.functional.leaky_relu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/elu.html">nn.functional.elu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/selu.html">nn.functional.selu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/gelu.html">nn.functional.gelu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/sigmoid.html">nn.functional.sigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/tanh.html">nn.functional.tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/activation/softmax.html">nn.functional.softmax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/attention/index.html">Attention Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/attention/scaled_dot_product_attention.html">nn.functional.scaled_dot_product_attention</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/conv/index.html">Convolution Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/unfold.html">nn.functional.unfold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv1d.html">nn.functional.conv1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv2d.html">nn.functional.conv2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv3d.html">nn.functional.conv3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv_transpose1d.html">nn.functional.conv_transpose1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv_transpose2d.html">nn.functional.conv_transpose2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/conv/conv_transpose3d.html">nn.functional.conv_transpose3d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/pool/index.html">Pooling Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/avg_pool1d.html">nn.functional.avg_pool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/avg_pool2d.html">nn.functional.avg_pool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/avg_pool3d.html">nn.functional.avg_pool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/max_pool1d.html">nn.functional.max_pool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/max_pool2d.html">nn.functional.max_pool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/max_pool3d.html">nn.functional.max_pool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_avg_pool1d.html">nn.functional.adaptive_avg_pool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_avg_pool2d.html">nn.functional.adaptive_avg_pool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_avg_pool3d.html">nn.functional.adaptive_avg_pool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_max_pool1d.html">nn.functional.adaptive_max_pool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_max_pool2d.html">nn.functional.adaptive_max_pool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/pool/adaptive_max_pool3d.html">nn.functional.adaptive_max_pool3d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/drop/index.html">Dropout Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/dropout.html">nn.functional.dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/dropout1d.html">nn.functional.dropout1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/dropout2d.html">nn.functional.dropout2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/dropout3d.html">nn.functional.dropout3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/alpha_dropout.html">nn.functional.alpha_dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/drop_block.html">nn.functional.drop_block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/drop/drop_path.html">nn.functional.drop_path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/norm/index.html">Normalization Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/normalize.html">nn.functional.normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/batch_norm.html">nn.functional.batch_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/layer_norm.html">nn.functional.layer_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/instance_norm.html">nn.functional.instance_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/group_norm.html">nn.functional.group_norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/norm/global_response_norm.html">nn.functional.global_response_norm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/loss/index.html">Loss Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/mse_loss.html">nn.functional.mse_loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/binary_cross_entropy.html">nn.functional.binary_cross_entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/binary_cross_entropy_with_logits.html">nn.functional.binary_cross_entropy_with_logits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/cross_entropy.html">nn.functional.cross_entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/nll_loss.html">nn.functional.nll_loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/loss/huber_loss.html">nn.functional.huber_loss</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/spatial/index.html">Spatial Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/spatial/affine_grid.html">nn.functional.affine_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/spatial/grid_sample.html">nn.functional.grid_sample</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/functions/util/index.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/util/interpolate.html">nn.functional.interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/util/rotate.html">nn.functional.rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/util/embedding.html">nn.functional.embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/functions/util/one_hot.html">nn.functional.one_hot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/init/index.html">Weight Initializations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/uniform.html">nn.init.uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/normal.html">nn.init.normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/constant.html">nn.init.constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/xavier_uniform.html">nn.init.xavier_uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/xavier_normal.html">nn.init.xavier_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/kaiming_uniform.html">nn.init.kaiming_uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/init/kaiming_normal.html">nn.init.kaiming_normal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/modules/index.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/linear/index.html">Linear Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/linear/Identity.html">nn.Identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/linear/Flatten.html">nn.Flatten</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/linear/Linear.html">nn.Linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/linear/Bilinear.html">nn.Bilinear</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/conv/index.html">Convolution Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/Unfold.html">nn.Unfold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/Conv1d.html">nn.Conv1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/Conv2d.html">nn.Conv2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/Conv3d.html">nn.Conv3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/ConvTranspose1d.html">nn.ConvTranspose1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/ConvTranspose2d.html">nn.ConvTranspose2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/conv/ConvTranspose3d.html">nn.ConvTranspose3d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/activation/index.html">Activation Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/ReLU.html">nn.ReLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/ReLU6.html">nn.ReLU6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/LeakyReLU.html">nn.LeakyReLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/ELU.html">nn.ELU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/SELU.html">nn.SELU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/GELU.html">nn.GELU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/Sigmoid.html">nn.Sigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/HardSigmoid.html">nn.HardSigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/Tanh.html">nn.Tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/Softmax.html">nn.Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/Swish.html">nn.Swish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/HardSwish.html">nn.HardSwish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/activation/Mish.html">nn.Mish</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/pool/index.html">Pooling Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AvgPool1d.html">nn.AvgPool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AvgPool2d.html">nn.AvgPool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AvgPool3d.html">nn.AvgPool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/MaxPool1d.html">nn.MaxPool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/MaxPool2d.html">nn.MaxPool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/MaxPool3d.html">nn.MaxPool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveAvgPool1d.html">nn.AdaptiveAvgPool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveAvgPool2d.html">nn.AdaptiveAvgPool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveAvgPool3d.html">nn.AdaptiveAvgPool3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveMaxPool1d.html">nn.AdaptiveMaxPool1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveMaxPool2d.html">nn.AdaptiveMaxPool2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/pool/AdaptiveMaxPool3d.html">nn.AdaptiveMaxPool3d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/norm/index.html">Normalization Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/BatchNorm1d.html">nn.BatchNorm1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/BatchNorm2d.html">nn.BatchNorm2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/BatchNorm3d.html">nn.BatchNorm3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/InstanceNorm1d.html">nn.InstanceNorm1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/InstanceNorm2d.html">nn.InstanceNorm2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/InstanceNorm3d.html">nn.InstanceNorm3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/LayerNorm.html">nn.LayerNorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/GroupNorm.html">nn.GroupNorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/norm/GlobalResponseNorm.html">nn.GlobalResponseNorm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/drop/index.html">Dropout Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/Dropout.html">nn.Dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/Dropout1d.html">nn.Dropout1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/Dropout2d.html">nn.Dropout2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/Dropout3d.html">nn.Dropout3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/AlphaDropout.html">nn.AlphaDropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/DropBlock.html">nn.DropBlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/drop/DropPath.html">nn.DropPath</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/loss/index.html">Loss Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/MSELoss.html">nn.MSELoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/BCELoss.html">nn.BCELoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/BCEWithLogitsLoss.html">nn.BCEWithLogitsLoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/CrossEntropyLoss.html">nn.CrossEntropyLoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/NLLLoss.html">nn.NLLLoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/loss/HuberLoss.html">nn.HuberLoss</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/vision/index.html">Vision Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/vision/Upsample.html">nn.Upsample</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/sparse/index.html">Sparse Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/sparse/Embedding.html">nn.Embedding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/rnn/index.html">Recurrent Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/RNNBase.html">nn.RNNBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/RNN.html">nn.RNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/LSTM.html">nn.LSTM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/GRU.html">nn.GRU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/RNNCell.html">nn.RNNCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/LSTMCell.html">nn.LSTMCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/rnn/GRUCell.html">nn.GRUCell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/attention/index.html">Attention Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/attention/ScaledDotProductAttention.html">nn.ScaledDotProductAttention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/attention/MultiHeadAttention.html">nn.MultiHeadAttention</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/transformer/index.html">Transformer Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/transformer/TransformerEncoderLayer.html">nn.TransformerEncoderLayer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/transformer/TransformerDecoderLayer.html">nn.TransformerDecoderLayer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/transformer/TransformerEncoder.html">nn.TransformerEncoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/transformer/TransformerDecoder.html">nn.TransformerDecoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/transformer/Transformer.html">nn.Transformer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/modules/einops/index.html">Einops Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/modules/einops/Rearrange.html">nn.Rearrange</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/fused/index.html">Fused Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/ConvBNReLU1d.html">nn.ConvBNReLU1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/ConvBNReLU2d.html">nn.ConvBNReLU2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/ConvBNReLU3d.html">nn.ConvBNReLU3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/DepthSeparableConv1d.html">nn.DepthSeparableConv1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/DepthSeparableConv2d.html">nn.DepthSeparableConv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/DepthSeparableConv3d.html">nn.DepthSeparableConv3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/SEModule.html">nn.SEModule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/fused/SelectiveKernel.html">nn.SelectiveKernel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/containers/index.html">Containers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/containers/Sequential.html">nn.Sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/containers/ModuleList.html">nn.ModuleList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/containers/ModuleDict.html">nn.ModuleDict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/containers/ParameterList.html">nn.ParameterList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/containers/ParameterDict.html">nn.ParameterDict</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/caches/index.html">Caches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/caches/Cache.html">nn.Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/caches/KVCache.html">nn.KVCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/caches/EncoderDecoderCache.html">nn.EncoderDecoderCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/caches/DynamicKVCache.html">nn.DynamicKVCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/caches/StaticKVCache.html">nn.StaticKVCache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/grad_norm.html">nn.utils.grad_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/get_total_norm.html">nn.utils.get_total_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/clip_grad_norm.html">nn.utils.clip_grad_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/clip_grad_value.html">nn.utils.clip_grad_value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/apply_chunking_to_forward.html">nn.utils.apply_chunking_to_forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nn/utilities/rnn/index.html">RNN Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/pad_sequence.html">nn.utils.rnn.pad_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/PackedSequence.html">nn.utils.rnn.PackedSequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/pack_padded_sequence.html">nn.utils.rnn.pack_padded_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/pad_packed_sequence.html">nn.utils.rnn.pad_packed_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/pack_sequence.html">nn.utils.rnn.pack_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nn/utilities/rnn/unpack_sequence.html">nn.utils.rnn.unpack_sequence</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../optim/optim.html">lucid.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim/Optimizer.html">optim.Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim/lr_scheduler.html">optim.lr_scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim/optimizers/index.html">Optimizers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/SGD.html">optim.SGD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/ASGD.html">optim.ASGD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/RMSprop.html">optim.RMSprop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/Rprop.html">optim.Rprop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/Adam.html">optim.Adam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/AdamW.html">optim.AdamW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/NAdam.html">optim.NAdam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/RAdam.html">optim.RAdam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/Adamax.html">optim.Adamax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/Adagrad.html">optim.Adagrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/optimizers/Adadelta.html">optim.Adadelta</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim/lr_scheduler/index.html">LR Schedulers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/LRScheduler.html">lr_scheduler.LRScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/LambdaLR.html">lr_scheduler.LambdaLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/StepLR.html">lr_scheduler.StepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/MultiStepLR.html">lr_scheduler.MultiStepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/ExponentialLR.html">lr_scheduler.ExponentialLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/CosineAnnealingLR.html">lr_scheduler.CosineAnnealingLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/ReduceLROnPlateau.html">lr_scheduler.ReduceLROnPlateau</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/CyclicLR.html">lr_scheduler.CyclicLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../optim/lr_scheduler/NoamScheduler.html">lr_scheduler.NoamScheduler</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../data/data.html">lucid.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/Dataset.html">data.Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/Subset.html">data.Subset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/TensorDataset.html">data.TensorDataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/ConcatDataset.html">data.ConcatDataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/DataLoader.html">data.DataLoader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/tokenizers/index.html">Tokenizers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data/tokenizers/Tokenizer.html">data.tokenizers.Tokenizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data/tokenizers/WordPieceTokenizer.html">data.tokenizers.WordPieceTokenizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data/tokenizers/WordPieceTokenizerFast.html">data.tokenizers.WordPieceTokenizerFast</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../data/utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data/utilities/random_split.html">data.random_split</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/datasets.html">lucid.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/image/index.html">Image Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../datasets/image/MNIST.html">MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../datasets/image/FashionMNIST.html">FashionMNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../datasets/image/CIFAR10.html">CIFAR10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../datasets/image/CIFAR100.html">CIFAR100</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Models</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../models.html">lucid.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mixins/index.html">Base Mixins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mixins/PreTrainedModelMixin.html">PreTrainedModelMixin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../imgclf/index.html">Image Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/lenet/LeNet.html">LeNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/lenet/lenet_1.html">lenet_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/lenet/lenet_4.html">lenet_4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/lenet/lenet_5.html">lenet_5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/alex/AlexNet_.html">AlexNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/alex/alexnet.html">alexnet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/zfnet/ZFNet_.html">ZFNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/zfnet/zfnet.html">zfnet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/vgg/VGGNet.html">VGGNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vgg/vggnet_11.html">vggnet_11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vgg/vggnet_13.html">vggnet_13</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vgg/vggnet_16.html">vggnet_16</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vgg/vggnet_19.html">vggnet_19</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/inception/Inception.html">Inception</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception/inception_v1.html">inception_v1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception/inception_v3.html">inception_v3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception/inception_v4.html">inception_v4</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/inception_res/InceptionResNet.html">Inception-ResNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_res/inception_resnet_v1.html">inception_resnet_v1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_res/inception_resnet_v2.html">inception_resnet_v2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/resnet/ResNet.html">ResNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_18.html">resnet_18</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_34.html">resnet_34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_50.html">resnet_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_101.html">resnet_101</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_152.html">resnet_152</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_200.html">resnet_200</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_269.html">resnet_269</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/resnet_1001.html">resnet_1001</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/wide_resnet_50.html">wide_resnet_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnet/wide_resnet_101.html">wide_resnet_101</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/resnext/ResNeXt.html">ResNeXt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_50_32x4d.html">resnext_50_32x4d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_101_32x4d.html">resnext_101_32x4d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_101_32x8d.html">resnext_101_32x8d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_101_32x16d.html">resnext_101_32x16d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_101_32x32d.html">resnext_101_32x32d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnext/resnext_101_64x4d.html">resnext_101_64x4d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/resnest/ResNeSt.html">ResNeSt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_14.html">resnest_14</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_26.html">resnest_26</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_50.html">resnest_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_101.html">resnest_101</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_200.html">resnest_200</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_269.html">resnest_269</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_50_4s2x40d.html">resnest_50_4s2x40d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/resnest/resnest_50_1s4x24d.html">resnest_50_1s4x24d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/senet/SENet.html">SENet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnet_18.html">se_resnet_18</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnet_34.html">se_resnet_34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnet_50.html">se_resnet_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnet_101.html">se_resnet_101</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnet_152.html">se_resnet_152</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnext_50_32x4d.html">se_resnext_50_32x4d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnext_101_32x4d.html">se_resnext_101_32x4d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnext_101_32x8d.html">se_resnext_101_32x8d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/senet/se_resnext_101_64x4d.html">se_resnext_101_64x4d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/sknet/SKNet.html">SKNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/sknet/sk_resnet_18.html">sk_resnet_18</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/sknet/sk_resnet_34.html">sk_resnet_34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/sknet/sk_resnet_50.html">sk_resnet_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/sknet/sk_resnext_50_32x4d.html">sk_resnext_50_32x4d</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/dense/DenseNet.html">DenseNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/dense/densenet_121.html">densenet_121</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/dense/densenet_169.html">densenet_169</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/dense/densenet_201.html">densenet_201</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/dense/densenet_264.html">densenet_264</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/xception/Xception_.html">Xception</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/xception/xception.html">xception</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/mobile/MobileNet_.html">MobileNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet.html">mobilenet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/mobile/MobileNet_V2_.html">MobileNet-v2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v2.html">mobilenet_v2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/mobile/MobileNet_V3.html">MobileNet-v3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v3_small.html">mobilenet_v3_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v3_large.html">mobilenet_v3_large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/mobile/MobileNet_V4.html">MobileNet-v4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v4_conv_small.html">mobilenet_v4_conv_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v4_conv_medium.html">mobilenet_v4_conv_medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v4_conv_large.html">mobilenet_v4_conv_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v4_hybrid_medium.html">mobilenet_v4_hybrid_medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/mobile/mobilenet_v4_hybrid_large.html">mobilenet_v4_hybrid_large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/efficient/EfficientNet.html">EfficientNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b0.html">efficientnet_b0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b1.html">efficientnet_b1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b2.html">efficientnet_b2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b3.html">efficientnet_b3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b4.html">efficientnet_b4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b5.html">efficientnet_b5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b6.html">efficientnet_b6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_b7.html">efficientnet_b7</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/efficient/EfficientNet_V2.html">EfficientNet-v2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_v2_s.html">efficientnet_v2_s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_v2_m.html">efficientnet_v2_m</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_v2_l.html">efficientnet_v2_l</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficient/efficientnet_v2_xl.html">efficientnet_v2_xl</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/convnext/ConvNeXt.html">ConvNeXt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_tiny.html">convnext_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_small.html">convnext_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_base.html">convnext_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_large.html">convnext_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_xlarge.html">convnext_xlarge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/convnext/ConvNeXt_V2.html">ConvNeXt-v2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_atto.html">convnext_v2_atto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_femto.html">convnext_v2_femto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_pico.html">convnext_v2_pico</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_nano.html">convnext_v2_nano</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_tiny.html">convnext_v2_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_base.html">convnext_v2_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_large.html">convnext_v2_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/convnext/convnext_v2_huge.html">convnext_v2_huge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/inception_next/InceptionNeXt.html">InceptionNeXt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_next/inception_next_atto.html">inception_next_atto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_next/inception_next_tiny.html">inception_next_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_next/inception_next_small.html">inception_next_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/inception_next/inception_next_base.html">inception_next_base</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/coatnet/CoAtNet.html">CoAtNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_0.html">coatnet_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_1.html">coatnet_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_2.html">coatnet_2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_3.html">coatnet_3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_4.html">coatnet_4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_5.html">coatnet_5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_6.html">coatnet_6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/coatnet/coatnet_7.html">coatnet_7</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/cspnet/CSPNet.html">CSPNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cspnet/csp_resnet_50.html">csp_resnet_50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cspnet/csp_resnext_50_32x4d.html">csp_resnext_50_32x4d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cspnet/csp_darknet_53.html">csp_darknet_53</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/vit/ViT.html">ViT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vit/vit_tiny.html">vit_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vit/vit_small.html">vit_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vit/vit_base.html">vit_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vit/vit_large.html">vit_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/vit/vit_huge.html">vit_huge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/swin/SwinTransformer.html">Swin Transformer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_tiny.html">swin_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_small.html">swin_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_base.html">swin_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_large.html">swin_large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/swin/SwinTransformer_V2.html">Swin Transformer-v2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_tiny.html">swin_v2_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_small.html">swin_v2_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_base.html">swin_v2_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_large.html">swin_v2_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_huge.html">swin_v2_huge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/swin/swin_v2_giant.html">swin_v2_giant</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/cvt/CvT.html">CvT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cvt/cvt_13.html">cvt_13</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cvt/cvt_21.html">cvt_21</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/cvt/cvt_w24.html">cvt_w24</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/pvt/PVT.html">PVT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_tiny.html">pvt_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_small.html">pvt_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_medium.html">pvt_medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_large.html">pvt_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_huge.html">pvt_huge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/pvt/PVT_V2.html">PVT-v2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b0.html">pvt_v2_b0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b1.html">pvt_v2_b1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b2.html">pvt_v2_b2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b2_li.html">pvt_v2_b2_li</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b3.html">pvt_v2_b3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b4.html">pvt_v2_b4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/pvt/pvt_v2_b5.html">pvt_v2_b5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/crossvit/CrossViT.html">CrossViT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_tiny.html">crossvit_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_small.html">crossvit_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_base.html">crossvit_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_9.html">crossvit_9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_15.html">crossvit_15</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_18.html">crossvit_18</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_9_dagger.html">crossvit_9_dagger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_15_dagger.html">crossvit_15_dagger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/crossvit/crossvit_18_dagger.html">crossvit_18_dagger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/maxvit/MaxViT.html">MaxViT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/maxvit/maxvit_tiny.html">maxvit_tiny</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/maxvit/maxvit_small.html">maxvit_small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/maxvit/maxvit_base.html">maxvit_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/maxvit/maxvit_large.html">maxvit_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/maxvit/maxvit_xlarge.html">maxvit_xlarge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../imgclf/efficientformer/EfficientFormer.html">EfficientFormer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficientformer/efficientformer_l1.html">efficientformer_l1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficientformer/efficientformer_l3.html">efficientformer_l3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../imgclf/efficientformer/efficientformer_l7.html">efficientformer_l7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Image Generation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../autoencoder/VAE.html">VAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="DDPM.html">DDPM</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NCSN</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../objdet/index.html">Object Detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/utilities/index.html">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/iou.html">util.iou</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/nms.html">util.nms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/bbox_to_delta.html">util.bbox_to_delta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/apply_deltas.html">util.apply_deltas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/clip_boxes.html">util.clip_boxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/SelectiveSearch.html">util.SelectiveSearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/ROIAlign.html">util.ROIAlign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/MultiScaleROIAlign.html">util.MultiScaleROIAlign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/utilities/FPN.html">util.FPN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/rcnn/RCNN.html">R-CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/rcnn/FastRCNN.html">Fast R-CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/faster_rcnn/FasterRCNN.html">Faster R-CNN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/faster_rcnn/faster_rcnn_resnet_50_fpn.html">faster_rcnn_resnet_50_fpn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/faster_rcnn/faster_rcnn_resnet_101_fpn.html">faster_rcnn_resnet_101_fpn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/yolo/index.html">YOLO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/yolo/v1/YOLO_V1_.html">YOLO-v1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v1/yolo_v1.html">yolo_v1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v1/yolo_v1_tiny.html">yolo_v1_tiny</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/yolo/v2/YOLO_V2_.html">YOLO-v2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v2/yolo_v2.html">yolo_v2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v2/yolo_v2_tiny.html">yolo_v2_tiny</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/yolo/v3/YOLO_V3_.html">YOLO-v3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v3/yolo_v3.html">yolo_v3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v3/yolo_v3_tiny.html">yolo_v3_tiny</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/yolo/v4/YOLO_V4_.html">YOLO-v4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../objdet/yolo/v4/yolo_v4.html">yolo_v4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/efficientdet/EfficientDet.html">EfficientDet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d0.html">efficientdet_d0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d1.html">efficientdet_d1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d2.html">efficientdet_d2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d3.html">efficientdet_d3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d4.html">efficientdet_d4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d5.html">efficientdet_d5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d6.html">efficientdet_d6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/efficientdet/efficientdet_d7.html">efficientdet_d7</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../objdet/detr/DETR.html">DETR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/detr/detr_r50.html">detr_r50</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../objdet/detr/detr_r101.html">detr_r101</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../seq2seq/index.html">Sequence-to-Sequence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../seq2seq/transformer/Transformer.html">Transformer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../seq2seq/transformer/transformer_base.html">transformer_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seq2seq/transformer/transformer_big.html">transformer_big</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../seqclf/index.html">Sequence Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../seqclf/bert/BERT.html">BERT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTConfig.html">BERTConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForPreTraining.html">BERTForPreTraining</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForMaskedLM.html">BERTForMaskedLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForCausalLM.html">BERTForCausalLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForNextSentencePrediction.html">BERTForNextSentencePrediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForSequenceClassification.html">BERTForSequenceClassification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForTokenClassification.html">BERTForTokenClassification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/BERTForQuestionAnswering.html">BERTForQuestionAnswering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_pre_training_base.html">bert_for_pre_training_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_pre_training_large.html">bert_for_pre_training_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_masked_lm_base.html">bert_for_masked_lm_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_masked_lm_large.html">bert_for_masked_lm_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_causal_lm_base.html">bert_for_causal_lm_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_causal_lm_large.html">bert_for_causal_lm_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_next_sentence_prediction_base.html">bert_for_next_sentence_prediction_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_next_sentence_prediction_large.html">bert_for_next_sentence_prediction_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_sequence_classification_base.html">bert_for_sequence_classification_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_sequence_classification_large.html">bert_for_sequence_classification_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_token_classification_base.html">bert_for_token_classification_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_token_classification_large.html">bert_for_token_classification_large</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_question_answering_base.html">bert_for_question_answering_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../seqclf/bert/bert_for_question_answering_large.html">bert_for_question_answering_large</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Weights</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../weights/weights.html">lucid.weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../weights/list.html">Pre-Trained Weights</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Transformation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../transforms/transforms.html">lucid.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transforms/Compose.html">transforms.Compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transforms/ToTensor.html">transforms.ToTensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transforms/image/index.html">Image Transforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/Normalize.html">transforms.Normalize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/Resize.html">transforms.Resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/RandomHorizontalFlip.html">transforms.RandomHorizontalFlip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/RandomVerticalFlip.html">transforms.RandomVerticalFlip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/RandomCrop.html">transforms.RandomCrop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/CenterCrop.html">transforms.CenterCrop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/RandomRotation.html">transforms.RandomRotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../transforms/image/RandomGrayscale.html">transforms.RandomGrayscale</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Visualization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../visual/visual.html">lucid.visual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visual/Mermaid.html">Mermaid Charts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../visual/build_tensor_mermaid_chart.html">visual.build_tensor_mermaid_chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visual/build_module_mermaid_chart.html">visual.build_module_mermaid_chart</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Porting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../porting/save.html">lucid.save</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../porting/load.html">lucid.load</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../others/Numeric.html">lucid.Numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../others/no_grad.html">lucid.no_grad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../others/grad_enabled.html">lucid.grad_enabled</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../others/count_flops.html">lucid.count_flops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../others/newaxis.html">lucid.newaxis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../others/register_model.html">lucid.register_model</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#lucid.models.NCSN"><code class="docutils literal notranslate"><span class="pre">NCSN</span></code></a></li>
<li><a class="reference internal" href="#class-signature">Class Signature</a></li>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#returns">Returns</a></li>
<li><a class="reference internal" href="#training-objective-annealed-dsm">Training Objective (Annealed DSM)</a></li>
<li><a class="reference internal" href="#sampling-annealed-langevin-dynamics">Sampling (Annealed Langevin Dynamics)</a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#lucid.models.NCSN.make_sigmas"><code class="docutils literal notranslate">make_sigmas()</span></code></a></li>
<li><a class="reference internal" href="#lucid.models.NCSN.set_sigmas"><code class="docutils literal notranslate">set_sigmas()</span></code></a></li>
<li><a class="reference internal" href="#lucid.models.NCSN.get_loss"><code class="docutils literal notranslate">get_loss()</span></code></a></li>
<li><a class="reference internal" href="#lucid.models.NCSN.sample"><code class="docutils literal notranslate">sample()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../../index.html"><span itemprop="name">Lucid</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">Image Generation</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">NCSN</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <div class="copy-page-wrapper relative pb-4 lg:absolute lg:top-8 lg:right-6 xl:right-12">
  <div id="copy-page-trigger">
    <button
      type="button"
      class="js-copy px-3 py-1 inline-flex items-center gap-1"
      data-url="https://chanlumerico.github.io/lucid/_sources/models/imggen/diffusion/NCSN.rst.txt"
    >
      <i class="i-lucide" data-icon="copy"></i>
      <span>Copy page</span>
    </button>
    <button class="js-menu px-2 py-1" type="button" aria-label="More actions"
      aria-haspopup="menu" aria-expanded="false" aria-controls="copy-page-content">
      <i class="i-lucide chevron-down"></i>
    </button>
  </div>
  <div id="copy-page-content" role="menu" aria-orientation="vertical" aria-hidden="true">
    <div role="presentation">
      <div class="flex flex-col" role="group">
        <button class="js-copy" type="button" role="menuitem"
          data-url="https://chanlumerico.github.io/lucid/_sources/models/imggen/diffusion/NCSN.rst.txt">
          <span class="iconify-icon">
            <i class="i-lucide" data-icon="copy"></i>
          </span>
          <span>Copy page</span>
        </button>
        <a role="menuitem" href="https://chanlumerico.github.io/lucid/_sources/models/imggen/diffusion/NCSN.rst.txt" target="_blank" rel="nofollow"><iconify-icon icon="bi:code-slash"></iconify-icon>
            <span>View Source</span></a><a role="menuitem" href="https://chatgpt.com/?hints=search&q=Read%20https%3A//chanlumerico.github.io/lucid/_sources/models/imggen/diffusion/NCSN.rst.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:openai"></iconify-icon>
          <span>Open in ChatGPT</span>
        </a><a role="menuitem" href="https://claude.ai/new?q=Read%20https%3A//chanlumerico.github.io/lucid/_sources/models/imggen/diffusion/NCSN.rst.txt%20so%20I%20can%20ask%20questions%20about%20it." target="_blank" rel="nofollow">
          <iconify-icon icon="bi:claude"></iconify-icon>
          <span>Open in Claude</span>
        </a></div>
    </div>
  </div>
</div><article class="yue" role="main">
          <section id="ncsn">
<h1>NCSN<a class="headerlink" href="#ncsn" title="Link to this heading"></a></h1>
<p><span class="badge diffusion">Diffusion</span> <span class="badge score_based_diffusion">Score-Based Diffusion</span> <span class="badge normal">Image Generation</span></p>
<dl class="py class">
<dt class="sig sig-object py" id="lucid.models.NCSN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lucid.models.</span></span><span class="sig-name descname"><span class="pre">NCSN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_by_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lucid.models.NCSN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p>The <cite>NCSN</cite> class implements a Noise Conditional Score Network (NCSN), a score-based
generative model trained with annealed denoising score matching.</p>
<p>Given a noise scale <span class="math notranslate nohighlight">\(\sigma\)</span>, the model learns the score
<span class="math notranslate nohighlight">\(\nabla_{\mathbf{x}} \log p_\sigma(\mathbf{x})\)</span> and generates samples using
annealed Langevin dynamics over a descending noise schedule.</p>
<p><strong>Total Parameters</strong>: 12,471,555 (Default)</p>
<pre id="id1" class="mermaid">
        %%{init: {&quot;flowchart&quot;:{&quot;curve&quot;:&quot;monotoneX&quot;,&quot;nodeSpacing&quot;:50,&quot;rankSpacing&quot;:50}} }%%
flowchart LR
  linkStyle default stroke-width:2.0px
  subgraph sg_m0[&quot;&lt;span style='font-size:20px;font-weight:700'&gt;NCSN&lt;/span&gt;&quot;]
  style sg_m0 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
    m1[&quot;Conv2d&lt;br/&gt;&lt;span style='font-size:11px;color:#c53030;font-weight:400'&gt;(1,3,64,64)  (1,128,64,64)&lt;/span&gt;&quot;];
    subgraph sg_m2[&quot;_RCUBlock x 4&quot;]
    style sg_m2 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
      m2_in([&quot;Input&quot;]);
      m2_out([&quot;Output&quot;]);
  style m2_in fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
  style m2_out fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
      subgraph sg_m3[&quot;units&quot;]
        direction TB;
      style sg_m3 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m4[&quot;_ResidualConvUnit x 2&quot;]
          direction TB;
        style sg_m4 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m4_in([&quot;Input&quot;]);
          m4_out([&quot;Output&quot;]);
  style m4_in fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
  style m4_out fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
          m5[&quot;_CondInstanceNorm&lt;br/&gt;&lt;span style='font-size:11px;font-weight:400'&gt;(1,128,64,64)x2  (1,128,64,64)&lt;/span&gt;&quot;];
          m6[&quot;_Conv3x3&quot;];
          m7[&quot;_CondInstanceNorm&lt;br/&gt;&lt;span style='font-size:11px;font-weight:400'&gt;(1,128,64,64)x2  (1,128,64,64)&lt;/span&gt;&quot;];
          m8[&quot;_Conv3x3&quot;];
          m9[&quot;ELU&quot;];
        end
      end
    end
    subgraph sg_m10[&quot;_RefineBlock x 4&quot;]
    style sg_m10 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
      m10_in([&quot;Input&quot;]);
      m10_out([&quot;Output&quot;]);
  style m10_in fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
  style m10_out fill:#e2e8f0,stroke:#64748b,stroke-width:1px;
      subgraph sg_m11[&quot;adapters&quot;]
        direction TB;
      style sg_m11 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m12[&quot;_CondAdapter&quot;]
          direction TB;
        style sg_m12 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m13[&quot;ELU&quot;];
        end
      end
      subgraph sg_m14[&quot;rcu_in&quot;]
        direction TB;
      style sg_m14 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m15[&quot;_RCUBlock&quot;]
          direction TB;
        style sg_m15 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m16[&quot;ModuleList&lt;br/&gt;&lt;span style='font-size:11px;font-weight:400'&gt;(1,128,64,64)x2  (1,128,64,64)&lt;/span&gt;&quot;];
        end
      end
      subgraph sg_m17[&quot;_MultiResFusion&quot;]
        direction TB;
      style sg_m17 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m18[&quot;norms&quot;]
          direction TB;
        style sg_m18 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m19[&quot;_CondInstanceNorm&quot;];
        end
        subgraph sg_m20[&quot;convs&quot;]
          direction TB;
        style sg_m20 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m21[&quot;Conv2d&quot;];
        end
        m22[&quot;ELU&quot;];
      end
      subgraph sg_m23[&quot;_ChainedResPooling&quot;]
        direction TB;
      style sg_m23 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m24[&quot;norms&quot;]
          direction TB;
        style sg_m24 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m25([&quot;_CondInstanceNorm x 4&lt;br/&gt;&lt;span style='font-size:11px;font-weight:400'&gt;(1,128,64,64)x2  (1,128,64,64)&lt;/span&gt;&quot;]);
        end
        subgraph sg_m26[&quot;convs&quot;]
          direction TB;
        style sg_m26 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m27([&quot;Conv2d x 4&quot;]);
        end
        m28[&quot;ELU&quot;];
      end
      subgraph sg_m29[&quot;_RCUBlock&quot;]
        direction TB;
      style sg_m29 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
        subgraph sg_m30[&quot;units&quot;]
          direction TB;
        style sg_m30 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
          m31([&quot;_ResidualConvUnit x 2&lt;br/&gt;&lt;span style='font-size:11px;font-weight:400'&gt;(1,128,64,64)x2  (1,128,64,64)&lt;/span&gt;&quot;]);
        end
      end
    end
    subgraph sg_m32[&quot;_CondInstanceNorm&quot;]
    style sg_m32 fill:#000000,fill-opacity:0.05,stroke:#000000,stroke-opacity:0.75,stroke-width:1px
      m33[&quot;InstanceNorm2d&quot;];
      m34[&quot;Embedding&lt;br/&gt;&lt;span style='font-size:11px;color:#475569;font-weight:400'&gt;(1)  (1,256)&lt;/span&gt;&quot;];
    end
    m35[&quot;ELU&quot;];
    m36[&quot;Conv2d&lt;br/&gt;&lt;span style='font-size:11px;color:#c53030;font-weight:400'&gt;(1,128,64,64)  (1,3,64,64)&lt;/span&gt;&quot;];
  end
  input[&quot;Input&lt;br/&gt;&lt;span style='font-size:11px;color:#a67c00;font-weight:400'&gt;(1,3,64,64)&lt;/span&gt;&quot;];
  output[&quot;Output&lt;br/&gt;&lt;span style='font-size:11px;color:#a67c00;font-weight:400'&gt;(1,3,64,64)&lt;/span&gt;&quot;];
  style input fill:#fff3cd,stroke:#a67c00,stroke-width:1px;
  style output fill:#fff3cd,stroke:#a67c00,stroke-width:1px;
  style m1 fill:#ffe8e8,stroke:#c53030,stroke-width:1px;
  style m9 fill:#faf5ff,stroke:#6b46c1,stroke-width:1px;
  style m13 fill:#faf5ff,stroke:#6b46c1,stroke-width:1px;
  style m21 fill:#ffe8e8,stroke:#c53030,stroke-width:1px;
  style m22 fill:#faf5ff,stroke:#6b46c1,stroke-width:1px;
  style m27 fill:#ffe8e8,stroke:#c53030,stroke-width:1px;
  style m28 fill:#faf5ff,stroke:#6b46c1,stroke-width:1px;
  style m33 fill:#e6fffa,stroke:#2c7a7b,stroke-width:1px;
  style m34 fill:#f1f5f9,stroke:#475569,stroke-width:1px;
  style m35 fill:#faf5ff,stroke:#6b46c1,stroke-width:1px;
  style m36 fill:#ffe8e8,stroke:#c53030,stroke-width:1px;
  input --&gt; m1;
  m1 -.-&gt; m5;
  m10_in --&gt; m13;
  m10_out -.-&gt; m10_in;
  m10_out --&gt; m33;
  m16 -.-&gt; m25;
  m25 --&gt; m28;
  m27 -.-&gt; m25;
  m27 --&gt; m31;
  m28 --&gt; m27;
  m2_in -.-&gt; m5;
  m2_out --&gt; m16;
  m2_out -.-&gt; m2_in;
  m31 -.-&gt; m10_in;
  m31 --&gt; m10_out;
  m33 --&gt; m34;
  m34 --&gt; m35;
  m35 --&gt; m36;
  m36 --&gt; output;
  m4_in -.-&gt; m5;
  m4_out -.-&gt; m2_in;
  m5 -.-&gt; m9;
  m6 --&gt; m7;
  m7 -.-&gt; m9;
  m8 --&gt; m4_in;
  m9 --&gt; m2_out;
  m9 --&gt; m4_out;
  m9 --&gt; m6;
  m9 --&gt; m8;
    </pre><section id="class-signature">
<h2>Class Signature<a class="headerlink" href="#class-signature" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">class</span><span class="w"> </span><span class="nc">NCSN</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">in_channels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">nf</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">dilations</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
</span><span data-line="6">    <span class="n">scale_by_sigma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="7"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>):
Number of channels in the input image.</p></li>
<li><p><strong>nf</strong> (<em>int</em>):
Base feature width used by the internal RefineNet-style backbone.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>):
Number of noise levels (i.e., the length of the noise schedule). This is also the
number of class labels used for conditional normalization inside the network.</p></li>
<li><p><strong>dilations</strong> (<em>Sequence[int]</em>):
Four dilation values used in the four RCU stages.</p></li>
<li><p><strong>scale_by_sigma</strong> (<em>bool</em>):
If <cite>True</cite>, the network output is divided by the per-sample noise level
<span class="math notranslate nohighlight">\(\sigma\)</span> (matching the original NCSN formulation).</p></li>
</ul>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<p>Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">NCSN.get_loss()</span></code> to compute the annealed DSM loss and sampled noise labels:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">loss</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ncsn</span><span class="o">.</span><span class="n">get_loss</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>
</div>
<ul class="simple">
<li><p><strong>loss</strong> (<em>Tensor</em>):
Scalar training loss.</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>):
Integer tensor of shape <cite>(N,)</cite> indicating the sampled noise level index per batch item.</p></li>
</ul>
</section>
<section id="training-objective-annealed-dsm">
<h2>Training Objective (Annealed DSM)<a class="headerlink" href="#training-objective-annealed-dsm" title="Link to this heading"></a></h2>
<p>Let <span class="math notranslate nohighlight">\(\epsilon \sim \mathcal{N}(0, I)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_\sigma = \mathbf{x} + \sigma \epsilon\)</span>.
With the score network <span class="math notranslate nohighlight">\(s_\theta(\mathbf{x}_\sigma, \sigma)\)</span>, the annealed denoising score matching loss is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathcal{L}(\theta) = \mathbb{E}_{\mathbf{x}, \sigma, \epsilon}\left[\left\| \sigma\, s_\theta(\mathbf{x}_\sigma, \sigma) + \epsilon \right\|^2\right]\]</div>
</div>
<p>Implemented via <code class="xref py py-meth docutils literal notranslate"><span class="pre">NCSN.get_loss()</span></code>.</p>
</section>
<section id="sampling-annealed-langevin-dynamics">
<h2>Sampling (Annealed Langevin Dynamics)<a class="headerlink" href="#sampling-annealed-langevin-dynamics" title="Link to this heading"></a></h2>
<p>Sampling iterates over noise levels <span class="math notranslate nohighlight">\(\sigma_1 &gt; \sigma_2 &gt; \cdots &gt; \sigma_K\)</span> and performs Langevin updates:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbf{x} \leftarrow \mathbf{x} + \eta\, s_\theta(\mathbf{x}, \sigma_i) + \sqrt{2\eta}\,\mathbf{z}, \quad \mathbf{z}\sim\mathcal{N}(0, I)\]</div>
</div>
<p>In this implementation, the per-level step size is scaled as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\eta_i = \text{step\_lr}\left(\frac{\sigma_i}{\sigma_K}\right)^2\]</div>
</div>
<p>Implemented via <code class="xref py py-meth docutils literal notranslate"><span class="pre">NCSN.sample()</span></code>.</p>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="lucid.models.NCSN.make_sigmas">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">NCSN.</span></span><span class="sig-name descname"><span class="pre">make_sigmas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_begin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#lucid.models.NCSN.make_sigmas" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lucid.models.NCSN.set_sigmas">
<span class="sig-prename descclassname"><span class="pre">NCSN.</span></span><span class="sig-name descname"><span class="pre">set_sigmas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#lucid.models.NCSN.set_sigmas" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lucid.models.NCSN.get_loss">
<span class="sig-prename descclassname"><span class="pre">NCSN.</span></span><span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lucid.models.NCSN.get_loss" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lucid.models.NCSN.sample">
<span class="sig-prename descclassname"><span class="pre">NCSN.</span></span><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps_each</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denoise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'uniform'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'normal'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../../tensor/Tensor_.html#lucid.Tensor" title="lucid._tensor.tensor.Tensor"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#lucid.models.NCSN.sample" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">lucid</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">lucid.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">NCSN</span>
</span><span data-line="3">
</span><span data-line="4"><span class="n">model</span> <span class="o">=</span> <span class="n">NCSN</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span data-line="5"><span class="n">model</span><span class="o">.</span><span class="n">set_sigmas</span><span class="p">(</span><span class="n">NCSN</span><span class="o">.</span><span class="n">make_sigmas</span><span class="p">(</span><span class="n">sigma_begin</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">sigma_end</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">num_scales</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Training</span>
</span><span data-line="8"><span class="n">x</span> <span class="o">=</span> <span class="n">lucid</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
</span><span data-line="9"><span class="n">loss</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_loss</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span data-line="10"><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1"># Sampling</span>
</span><span data-line="13"><span class="k">with</span> <span class="n">lucid</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span data-line="14">    <span class="n">samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span data-line="15">        <span class="n">n_samples</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span><span data-line="16">        <span class="n">image_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
</span><span data-line="17">        <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span data-line="18">        <span class="n">n_steps_each</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span data-line="19">        <span class="n">step_lr</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">,</span>
</span><span data-line="20">        <span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21">    <span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><cite>set_sigmas()</cite> must be called before training or sampling, otherwise the model
does not know which noise levels to use.</p>
</div>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="DDPM.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">DDPM</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="../../objdet/index.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Object Detection</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, ChanLumerico</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials"></div>
    </div>
  </div>
</footer>
      <script src="../../../_static/documentation_options.js?v=f5edd4dd"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../../_static/shibuya.js?v=cac61aee"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";





const initStyles = () => {
    const defaultStyle = document.createElement('style');
    defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}`;
    document.head.appendChild(defaultStyle);

    const fullscreenStyle = document.createElement('style');
    fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
    document.head.appendChild(fullscreenStyle);
}

// Detect if page has dark background
const isDarkTheme = () => {
    // We use a set of heuristics:
    // 1. Check for common dark mode classes or attributes
    // 2. Check computed background color brightness
    if (document.documentElement.classList.contains('dark') ||
        document.documentElement.getAttribute('data-theme') === 'dark' ||
        document.body.classList.contains('dark') ||
        document.body.getAttribute('data-theme') === 'dark') {
        // console.log("Dark theme detected via class/attribute");
        return true;
    }
    if (document.documentElement.classList.contains('light') ||
        document.documentElement.getAttribute('data-theme') === 'light' ||
        document.body.classList.contains('light') ||
        document.body.getAttribute('data-theme') === 'light') {
        // console.log("Light theme detected via class/attribute");
        return false;
    }
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        // console.log("Dark theme detected via prefers-color-scheme");
        return true;
    }
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        // console.log("Background color brightness:", brightness);
        return brightness < 128;
    }
    // console.log("No dark or light theme detected, defaulting to light theme");
    return false;
};

let darkTheme = isDarkTheme();
let modal = null;
let modalContent = null;
let previousScrollOffset = [window.scrollX, window.scrollY];

const runMermaid = async (rerun) => {
    console.log("Running mermaid diagrams, rerun =", rerun);
    // clear all existing mermaid charts
    let all_mermaids = document.querySelectorAll(".mermaid");

    if (rerun) {
        all_mermaids.forEach((el) => {
            if(!el.hasAttribute("data-original-code")) {
                // store original code
                // console.log(`Storing original code for first run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
            if(el.getAttribute("data-processed") === "true") {
                // remove and restore original
                el.removeAttribute("data-processed");
                // console.log(`Restoring original code for re-run: `, el.getAttribute('data-original-code'));
                el.innerHTML = el.getAttribute('data-original-code');
            } else {
                // store original code
                // console.log(`Storing original code for re-run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
        });
        await mermaid.run();
    }

    all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(() => runMermaid(false), 200);
        return;
    }

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    if (modal !== null ) {
        // Destroy existing modal
        modal.remove();
        modal = null;
        modalContent = null;
    }

    modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen"></button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            // Already processed, adjust button class if needed
            const existingBtn = mermaidDiv.parentNode.querySelector('.mermaid-fullscreen-btn');
            if (existingBtn) {
                existingBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
            }
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        container.appendChild(fullscreenBtn);
    });
};

const load = async () => {
    initStyles();

    await runMermaid(true);

    const reRunIfThemeChanges = async () => {
        const newDarkTheme = isDarkTheme();
        if (newDarkTheme !== darkTheme) {
            darkTheme = newDarkTheme;
            console.log("Theme change detected, re-running mermaid with", darkTheme ? "dark" : "default", "theme");
            await mermaid.initialize(
                {...JSON.parse(
                    `{"startOnLoad": false}`
                ),
                ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
                }
            );
            await runMermaid(true);
        }
    };

    // Update theme classes when theme changes
    const themeObserver = new MutationObserver(reRunIfThemeChanges);
    themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    themeObserver.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
};





console.log("Initializing mermaid with", darkTheme ? "dark" : "default", "theme");
mermaid.initialize(
    {...JSON.parse(
        `{"startOnLoad": false}`
    ),
    ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
    }
);

window.addEventListener("load", load);</script>
      <script src="../../../_static/mermaid-zoom.js?v=0408cfdf"></script></body>
</html>